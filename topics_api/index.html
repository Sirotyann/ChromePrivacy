<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <title>Topics API</title>
    <style></style>
    <!-- <script type="module" src="/taxonomy.js"></script>
    <script type="module" src="/main.js"></script> -->
    <script>
        async function getTopics() {
            try {
                if ('browsingTopics' in document &&
                    document.featurePolicy.allowsFeature('browsing-topics')) {
                    
                    const topics = await document.browsingTopics({ skipObservation: true});
                    console.log("Topics:", topics)
                } else {
                    console.log('document.browsingTopics() not supported');
                }

            } catch (error) {
                console.log('Error:', error);
            }
        }
    </script>
</head>

<body>
    <div class="container">
        <p>Topics API</p>
        <div>
            <button onclick="fetchWithBrowserTopicsHeader()">Send Fetch request</button>
            <button onclick="getTopics()">Get Topics</button>
        </div>
        <a href="https://birds-birds-birds-birds-birds.birds.com:8443/birds.html">birds-birds-birds-birds</a>
        <p>
            <label>log</label>
        <div id="log"></div>
        </p>
        <p>
            <label>fetch-data</label>
        <div id="fetch-data"></div>
        </p>
        <p id="no-topics" class="hidden">No topics observed yet: try visiting one of the sites above.</p>
        <p id="no-headers"></p>
    </div>
    <div>
        <ul>
            <li><a href="https://pets-animals-pets-cats.glitch.me">pets-animals-pets-cats.glitch.me</a></li>
            <li><a href="https://cats-cats-cats-cats.glitch.me">cats-cats-cats-cats.glitch.me</a></li>
            <li><a href="https://cats-pets-animals-pets.glitch.me">cats-pets-animals-pets.glitch.me</a></li>
            <li><a
                    href="https://cats-feline-meow-purr-whiskers-pet.glitch.me">cats-feline-meow-purr-whiskers-pet.glitch.me</a>
            </li>
        </ul>
    </div>
    <script type="text/javascript">
        document.browsingTopics().then(resp => {
            console.log("topics", resp)
        })

        function fetchWithBrowserTopicsHeader() {
            fetch('/fetchTopics', { browsingTopics: true }).
                then(function (response) {
                    console.log(response);
                });
        }
    </script>
</body>

</html>